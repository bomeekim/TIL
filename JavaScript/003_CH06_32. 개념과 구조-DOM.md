# 003_CH06_32. 개념과 구조-DOM

## DOM (Document Object Model)
- HTML 이라고하는 문자열 데이터를 **브라우저가 처리하기 위해서** 자체적으로 갖고 있게 되는 자료 구조
- 특정 언어에 종속되지는 않는다.
  - 왜? DOM이 API를 제공해주기 때문에
  - 따라서 Javascript 로 제어할 수도 있고, Python 이나 등으로도 할 수 있다. (Python 의 경우 BeautifulSoup 을 가지고 DOM을 조작할 수 있음)
- DOM 은 광범위한 기능을 제공하고 있으나 실제로 DOM 을 가지고 html 을 조작하는 방식은 앱의 규모가 커지면 커질 수록 유지 관리가 거의 힘들만큼 어렵게 만들어지는 구조를 만들게 된다.
  - DOM 에서 제공하는 API 는 저수준의 API 로 쓰면 쓸수록 애플리케이션이 복잡해지고 지저분해진다.
- 현대적입 웹 개발에서는 직접 DOM 에 접근하는 방식은 거의 지양하고 있다.
  - React, Vue.js 의 경우 DOM 을 직접 접근하지 못하도록 한다.


> 👀 그럼에도 불구하고 학습해야하는 이유는? DOM 이 **html 을 조작하는 유일한 방법**이기 때문, 어떤 방법을 사용하더라도 DOM API를 이용해 UI를 만드는 것이므로 DOM에 대한 이해가 필수적임


### 더 알아보기
- DOM 안에는 각종 node 들이 **트리 구조**로 되어 있다.
  - 요소들이 다른 0에서 N개의 요소들을 포함하는 식
  - DOM의 모든 요소들은 `node` 로 부터 상속을 받는다.
    - **모든 HTML Element 는 기본적으로 `node` 이다.**
  - node 의 기능
    - HTML 요소들에서 공통적으로 볼 수 있는 기능들은 다수가 Node의 기능이다.
      - textContent, childNodes, firstChild, lastChild, parentNode, cloneNode, appendChild, insertBefore, removeChilde 등
    - 또한, EventTarget을 상속받기 때문에 addEventListener 등의 기능을 가지고 있다.

> 📌 **DOM 이란? HTML이나 XML 문서를 실체로 나타내는 API**

> 👀 DOM 에 CSS 도 포함되나요? 🙅🏻‍♀️ 아니요! CSS 는 CSS Object Model, CSSOM 이란걸로 따로 만들어진다.

## 가상돔 (Virtual DOM)
DOM의 구조만 간결하게 흉내낸 자바스크립트 객체

### Single Page Application 이 만들어진 이유? 
- 과거에는 뭘 하던간에 웹 페이지를 새로 로딩해야했음 (사용자 경험 불편) 
- 이런것을 보완하려고 자바스크립트를 이용해 HTML 요소들을 선택해 필요한 곳만 바꾸기 시작했음 -> 이게 다 DOM 을 직접 조작해서 하는 것이 었음 (jQuery)
- 요즘엔 다음과 같은 이유로 jQuery 의 필요성이 줄어들었음
  1. 크로스 브라우징의 필요성이 줄어듦
  2. 순수 자바스크립트도 발전해졌음
  3. DOM 조작 방식도 React 등이 생겨나면서 대체됨
  4. 옛날 자바스크립트 방식을 사용하고 있었음

### vs. React, Vue 의 방식은?
1. 템플릿으로 HTML 요소를 코딩한다.
2. 그것들을 어떤 변수 등에 들어간 데이터에 연결해놓는다.
3. 데이터들에 맞춰서 알아서 화면이 바뀌게 된다.

> ✨ **이 과정에서 사용되는 것이 `가상 DOM` 이다.**

### 가상 DOM 이 만들어진 이유는?
- 실제 DOM은 이것저것 든 게 많고 무거운데, 이를 조작해서 하려면 컴퓨터에 부담, 속도도 느림
- 따라서 이를 간략한 자바스크립트 오브젝트로 변환한 다음에 시뮬레이션을 돌리고 가장 경제적으로 DOM 에 변화를 가하는 방법을 찾아낸다. -> 차이가 생겨나는 부분을 찾고 (`diffing`)그 부분만 실제 DOM에 반영한다. 


#### [참고] Svelte
- Svelte의 경우 자바스크립트 오브젝트로 변환한 다음에 시뮬레이션을 하는 과정이 생략되고, 이것들 없이도 효율적으로 DOM 을 조작한다.

> 👀 React, Vue 는 그럼 가상 DOM 을 왜 쓰는 건가?
- React랑 Vue는 라이브러리 또는 프레임워크 형태이고, Svelte 는 컴파일러이다.
- 여기서 차이가 있다.
- React, Vue는 런타임에서 실행된다. 즉, 브라우저가 자바스크립트 파일을 받아서 하는 작업이다. 가상돔은 이 런타임 과정에서 브라우저에 로드된 라이브러리로서 DOM에 가해지는 변화들을 최소한의 변경으로 구현할 방법을 찾는 방식이다. 
- 반면 Svelte는 위의 과정을 사이트가 배포되기 전에 미리 다 해두도록 한 것이다. -> 미리 다 계산해놓은 다음 그걸 빌드해서 내놓는 다는 것 즉, 브라우저로 결과물을 갖다주기 전에 컴퓨터에서 Node.js 로 컴파일을 하는 과정에서 다 이루어진다. 따라서 브라우저는 이런 것들을 다 알지 못해도 된다. => 용량 면에서 가볍고 DOM 의 조작도 빠르다.